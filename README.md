# 学生请假条自动生成系统

基于Python开发的图形化请假条生成工具，可自动填写学生信息、请假详情，并生成标准格式的请假条图片。

## 主要功能

- 可视化表单录入（Tkinter GUI）
- 自动加载预设配置（config.ini）
- 支持日期选择器、单选框等控件
- 自动计算请假天数
- 生成带电子签名的请假条图片
- 自动打开输出文件

## 文件结构

```
.
├── main.py          # 主程序
├── config.ini       # 配置文件
├── input.jpg        # 请假条模板图片
└── README.md        # 说明文档
```

## 使用方法

1. 准备环境：
   ```bash
   pip install Pillow tkinter tkcalendar configparser
   ```

2. 配置`config.ini`文件（详见配置说明）

3. 运行程序：
   ```bash
   python main.py
   ```

4. 填写表单并点击"生成"按钮

5. 生成的请假条将保存为`output.jpg`

## 配置说明

`config.ini`示例：
```ini
[Defaults]
学院 = 计算机工程学院
年级 = 2022级
专业 = 软件工程
班级 = 3班
姓名 = 张三
性别 = 男
民族 = 汉族
学号 = 2022080345
电话 = 13800138000
家长姓名 = 张大山
家长电话 = 13900139000
去处 = 校内宿舍
原因 = 身体不适需要休息
导员姓名 = 李老师
```

⚠️ **重要配置项**：
- 必须包含所有字段，不可删除任何配置项
- 家长电话需用字符串格式
- 去处/原因字段只支持单行的格式

## 依赖说明

| 库名称       | 用途                | 版本要求   |
|------------|-------------------|--------|
| Pillow     | 图片处理              | 9.0+   |
| tkinter    | 图形界面              | 内置     |
| tkcalendar | 日期选择控件            | 1.6.1+ |
| configparser | 配置文件读取           | 内置     |

## 常见问题

### 1. 启动报错"配置文件不存在"
✅ 解决方案：
- 确保`config.ini`与程序同目录
- 检查文件扩展名是否为`.ini`

### 2. 生成图片文字位置偏移
✅ 解决方案：
- 使用默认的`input.jpg`模板
- 确认已安装微软雅黑字体

### 3. 日期计算错误
✅ 检查要点：
- 开始日期 ≤ 结束日期
- 日期格式必须为YYYY-MM-DD

## 注意事项

1. **模板图片`input.jpg`**：
   - 文字区域不可修改
   - 必须保持文件名一致

2. **时间格式**：
   - 审批时间自动填充为当前时间
   - 支持手动修改为任意有效时间

3. **电子签名**：
   - 同意与否显示为绿色字体
   - 位置固定不可调整

## 版权声明

本程序仅供学习交流使用，实际使用时请遵守学校相关规章制度。模板图片版权归开发者所有，禁止用于商业用途。
